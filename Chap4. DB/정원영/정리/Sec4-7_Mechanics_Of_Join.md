# Chapter 4: 데이터베이스
## Section 4.7: 조인의 원리
### 4.7.1 중첩 루프 조인
- **중첩 루프 조인(NLJ, Nested Loop Join)**: 중첩 반복문과 같은 원리로 조건에 맞는 조인을 하는 방법으로 랜덤접근에 대한 비용이 많이 증가하기 때문에 대용량 테이블에서는 사용하지 않는다.
- **블록 중첩 루프 조인(BNL, Block Nested Loop)**: 조인할 테이블을 작은 블록으로 나눠서 블록 하나씩 중첩 루프 조인하는 방식이다.

### 4.7.2 정렬 병합 조인
- **정렬 병합 조인(Sorted Merge Join)**: 각각의 테이블을 조인할 필드 기준으로 정렬하고 정렬이 끝난 이후에 조인 작업을 수행하는 조인이다.
- (1)조인할 때 쓸 적절한 인덱스가 없고 (2)대용량의 테이블들을 조인하고 (3)조인 조건으로 '<', '>' 등의 범위 비교 연산자가 있을 때 사용한다.

### 4.7.3 해시 조인
- **해시 조인(Hash Join)**: 해시 테이블을 기반으로 조인하는 방법이다.
- 조인 하고자 하는 테이블이 메모리에 온전히 들어간다면 보통 중첩 루프 조인보다 더 효율적이다.
- '='의 동등 조인에서만 사용할 수 있다.
- MySQL의 해시 조인의 단계는 빌드 단계, 프로브 단계로 나뉜다.

#### 빌드 단계
- 입력 테이블 중 하나를 기반으로 메모리 내 해시 테이블을 빌드하는 단계이다.
- 두 테이블을 조인할 때, 주로 둘 중에 바이트가 더 작은 테이블을 기반으로 해서 테이블을 빌드하며, 조인에 사용되는 필드가 해시 테이블의 키로 사용된다.

#### 프로브 단계
- 레코드 읽기를 하면서 각 레코드에서 조인에 대응되는 필드 값을 가진 레코드를 찾아서 반환한다.
- 이로써 각 테이블은 한 번씩만 읽게 되어 중첩해서 두개의 테이블을 읽는 중첩 루프 조인보다 보통 성는이 더 좋다.